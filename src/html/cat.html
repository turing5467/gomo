<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">
    <title>商品列表</title>
    <script src="../js/jquery-1.12.4.js"></script>
    <script src="../js/kkpager.min.js"></script>
    <script src="../js/Cookie.js"></script>
    <script src="../js/cat.js"></script>
    <link rel="stylesheet" href="../css/base.min.css">
    <link rel="stylesheet" href="../css/footer.min.css">
    <link rel="stylesheet" href="../css/kkpager.min.css">
    <link rel="stylesheet" href="../css/cat.min.css">
</head>

<body>
    <div class="container">
        <div class="nSearchWarp">
            <div class="hot-tj">
                <span class="icon_tj">热卖<br>推荐</span>
                <ul class="hot-list" id="hot-list">
                    <script>
                        $.getJSON('../server/cat/hot_tj.json', (res) => {
                            $('#hot-list').html(() => {
                                return res.map((ele) => {

                                    return `
                                    <li class=item>
                                        <p class="pic">
                                            <a href=# title='${ele.name}'>
                                            <img src=${ele.pic} alt=${ele.name}></a>
                                        </p>
                                        <p class=name>
                                            <a href=# title='${ele.name}'>${ele.name}</a>
                                        </p>
                                        <p class=price>${ele.price}</p>
                                        <p class=btn>
                                            <a class=buy href=#>立即抢购</a>
                                        </p>
                                    </li>
                                    `;
                                }).join('');
                            })
                        })
                    </script>
                </ul>
            </div>
        </div>
        <div class="nSearchWarp">
            <div class="nSearch-crumb clearfix">
                <span id="category-first" catgoryid="cat10000001" data-code="9000000101-1" class="nSearch-crumb-tit-category">电脑 办公打印 文仪</span>

                <dl class="nSearch-crumb-category" catgoryid="cat10000015" id="category-second">
                    <dt class="category-name">电脑整机</dt>
                    <dd class="category-box clearfix" id="category-box-second" modelid="9000000102"></dd>
                </dl>

                <dl class="nSearch-crumb-category" catgoryid="cat10000015" id="category-third">
                    <dt class="category-name">台式电脑</dt>
                    <dd class="category-box" id="category-box-third" modelid="9000000103">
                        <a data-code="9000000103-1" href="//list.gome.com.cn/cat10000027.html">服务器</a>
                        <a data-code="9000000103-2" href="//list.gome.com.cn/cat10000092.html">笔记本</a>
                        <a data-code="9000000103-3" href="//list.gome.com.cn/cat10000093.html">台式主机</a>
                        <a data-code="9000000103-4" href="//list.gome.com.cn/cat10000094.html">平板电脑</a>
                        <a data-code="9000000103-5" href="//list.gome.com.cn/cat10000097.html">台式电脑</a>
                        <a data-code="9000000103-6" href="//list.gome.com.cn/cat10000099.html">一体机</a>
                        <a data-code="9000000103-7" href="//list.gome.com.cn/cat10005442.html">超极本</a>
                        <a data-code="9000000103-8" href="//list.gome.com.cn/cat18388430.html">笔记本配件</a>
                        <a data-code="9000000103-9" href="//list.gome.com.cn/cat32385590.html">游戏本</a>
                        <a data-code="9000000103-10" href="//list.gome.com.cn/cat35000228.html">二手电脑</a>
                    </dd>
                </dl>
                <a id="clearallfacts" class="nSearch-crumb-clearFacets" data-code="9000001100-0" href="//list.gome.com.cn/cat10000097.html">全部清空</a>
            </div>

            <div class="nSearchWarp nSearch-crumb-category-results">
                <span class="nFont14"><b class="nHeigh">台式电脑</b>商品筛选</span>
                <!-- <span>共 <em id="searchTotalNumber">657</em> 个商品</span> -->
            </div>
        </div>
        <div class="nSearchWarp nSearch-facets">
            <script>
                let facets = $('.nSearch-facets').eq(0);
                new Promise((resolve) => {
                    $.getJSON('../server/cat/facets.json?version=1', function(res) {

                        let brand = $('<div id=facets-category-brand class="facets-category clearfix"></div>').appendTo(facets);

                        brand.append(`<span class=fc-key><b>品牌：</b></span>`);
                        $('<div>').addClass('fc-content').html(() => {
                            let li_html = res.brands.map((ele) => {

                                return `<li class=c-brand>
                                    <a href="javascript:;" name=${ele.title} style=${ele.style}>
                                        ${ele.title}
                                    </a>
                                </li>`
                            }).join('');
                            return `<ul class="category-brand clearfix">${li_html}</ul>`
                        }).appendTo(brand);

                        res.commonFacets.forEach((e) => {
                            let common_facet = $('<div>').addClass('facets-category facets-category-common  clearfix');

                            common_facet.append(`<span class="fc-key fir">${e.key}</span>`);

                            $('<div>').addClass('fc-content').html(() => {
                                let li_html = e.contents.map((ee) => {
                                    return `<li><a class="facet">${ee}</a></li>`;
                                }).join('');
                                return `<ul class=clearfix>${li_html}<ul>`;
                            }).appendTo(common_facet);

                            common_facet.appendTo(facets);
                        });
                        resolve();
                    });
                }).then(() => {
                    facets.find('.facets-category-common:gt(3)').addClass('fc-hide');
                    facets.append(`<div class="fccc-control-warp">
            <span class="fccc-control" id="fc-common-show">更多选项（屏幕规格,显卡类型,硬盘容量,内存容量,操作系统,Game+游戏装备）</span>
            <span class="fccc-up" id="fc-common-hide">收起&nbsp;&nbsp;</span>
        </div>`);
                    let control_down = facets.find('.fccc-control').eq(0);
                    let control_up = facets.find('.fccc-up').eq(0);
                    let control_box = control_down.parent();
                    control_down.click((e) => {
                        $('.fc-hide').removeClass('fc-hide');
                        control_box.addClass('show');
                    })
                    control_up.click((e) => {
                        $('.facets-category-common:gt(3)').addClass('fc-hide');
                        control_box.removeClass('show');
                    })
                })
            </script>
        </div>
        <div class="nSearchWarp">
            <div class="nSearchWarp-main clearfix">
                <div class="product-right-box">
                    <script>
                        let prdBox = $('.product-right-box').eq(0);
                        $.getJSON('../server/cat/productLeft.json?version=1', (res) => {

                            //销量排行榜
                            let prd = $('<div id=prdRight-2>').appendTo(prdBox);

                            let prd_item = $('<div class=prd-right-normal>').appendTo(prd);

                            prd_item.append(`<h3 class=hd>${res[0].title}</h3>`);
                            $('<ul class="sell-product">').html(() => {
                                return res[0].lists.map((ele, index) => {
                                    return `<li class=active>
                                        <p class="num num${index+1}">${index+1}</p>
                                        <div class=pdetail>
                                            <p class=pic>
                                                <a class=bigD_item><img src=${ele.pic}></a>
                                            </p>    
                                            <p class=name>
                                                <a class=bigD_item>${ele.name}</a>
                                            </p>
                                            <p class=price>${ele.price}</p>
                                        </div>
                                    </li>`
                                }).join('');
                            }).appendTo(prd_item);

                            //另外两个
                            res.slice(1).forEach((ele, index) => {
                                let prd = $('<div id=prdRight-' + (index + 3) + '>').appendTo(prdBox);

                                let prd_item = $('<div class=prd-right-normal>').appendTo(prd);

                                prd_item.append(`<h3 class=hd>${ele.title}</h3>`);
                                $('<ul class=bd id=bigD_liulan>').html(() => {
                                    return ele.lists.map((e, index) => {
                                        return `<li class=buy-items>
                                            <div class=pic>
                                                <a class=bigD_item><img src=${e.pic}></a>
                                            </div>    
                                            <div class=price>${e.price}</div>
                                            <div class=name>
                                                <a class=bigD_item>${e.name}</a>
                                            </div>
                                    </li>`
                                    }).join('');
                                }).appendTo(prd_item)
                            })

                        })
                    </script>
                </div>
                <div class="product-left-list" id="product-left">
                    <div class="filter-box">
                        <ul class="filter-order-box">
                            <li id="sort-general" class="cur"><a href="javascript:;">综合</a></li>
                            <li id="sort-comment"><a href="javascript:;">评价</a></li>
                            <li id="sort-price">
                                <a href="javascript:;">价格</a>
                                <i class="icon-up-down"></i>
                            </li>
                        </ul>
                        <ul class="filter-priceRange-box clearfix">
                            <li class="priceRange-input"><input id="fc-lowPrice" maxlength="6" type="text" value="¥"></li>
                            <li class="priceRange-link">-</li>
                            <li class="priceRange-input"><input id="fc-highPrice" type="text" maxlength="6" value="¥"></li>
                            <li class="priceRange-btn"><a id="fc-btn-cancel" class="fc-btn-cancel" href="javascript:void(0)">清除</a></li>
                            <li class="priceRange-btn"><a id="fc-btn-ok" class="fc-btn-ok" href="javascript:void(0)">确定</a></li>
                        </ul>
                    </div>
                    <div class="product-box"></div>
                    <script>
                        $.ajax({
                            type: "get",
                            url: "../server/getProductData.php?version=2",
                            data: {
                                page: 0,
                                type: 0
                            },
                            dataType: "json",
                            success(response) {
                                render(response.data);
                                let links = $('.item-link');

                                links.each((i, e) => {
                                    let href = './detail.html?code=' + $(e).parents('li').attr('id');
                                    $(e).attr('href', href);
                                })
                            }
                        });
                    </script>
                    <div id="product-pager">
                        <div id="kkpager"></div>
                        <!-- 分页 -->
                        <script>
                            $.ajax({
                                type: "get",
                                url: "../server/getPageCount.php",
                                // data: "",
                                dataType: "json",
                                success: function(response) {
                                    console.log('page', response);
                                    kkpager.generPageHtml({
                                        pno: 1,
                                        total: response[1],
                                        totalRecords: response[0],
                                        mode: 'click',
                                        click(n) {
                                            this.selectPage(n);
                                            $('.product-box').eq(0).html('');
                                            $.ajax({
                                                type: "get",
                                                url: "../server/getProductData.php",
                                                data: {
                                                    page: n - 1,
                                                    type: getType(),
                                                },
                                                dataType: "json",
                                                success: function(response) {

                                                    if (response.status == 'success') {
                                                        render(response.data);
                                                    }
                                                }
                                            });
                                        }
                                    });
                                }
                            });
                        </script>
                    </div>
                </div>

            </div>
        </div>
        <script>
            $('<div id=gomo-foot>').load('./footer.html .gomo-foot').appendTo($('.container').eq(0));
        </script>
    </div>
</body>

</html>